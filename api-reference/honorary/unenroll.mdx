---
title: "Desenrolar Usuario Autorizado"
openapi: "PATCH /honorary/master-entities/{master_entity_id}/authorized-users/{rut}/"
---

## Qué hace

Remueve la autorización de un usuario para emitir boletas de honorarios desde una entidad emisora específica. Este endpoint usa el mismo método **PATCH** que enrolar, pero con `action="unenroll"` en el body. Al desenrolar:

1. Valida que el usuario esté actualmente enrolado para esa entidad
2. Desasocia la entidad del usuario
3. Desasocia la entidad de la credencial emisora
4. El usuario ya no puede emitir boletas desde esa cuenta para esa entidad

## Ejemplos de uso

- Remover permisos de un contador que ya no trabaja con una empresa específica
- Desautorizar un usuario temporalmente para una entidad
- Limpiar autorizadores inactivos del sistema
- Cambiar permisos de emisión de boletas para una entidad específica

## Reglas de negocio

### Acción requerida
Para desenrolar un usuario, se debe especificar explícitamente `action="unenroll"` en el body. Este endpoint usa el mismo método PATCH que enrolar, diferenciándose solo por el parámetro de acción.

### Validación de permisos
Solo el usuario que tiene acceso a la entidad emisora puede desenrolar. Se verifica que el usuario tenga acceso a la entidad emisora y que el usuario esté actualmente enrolado antes de proceder.

### Desasociación completa
Se remueve la asociación usuario-entidad y la asociación entidad-credencial. La entidad puede permanecer en el sistema pero sin permisos de emisión para ese usuario específico.

### Actualización del contexto
Después del desenrolamiento, el frontend debe actualizar el contexto. La entidad desaparecerá del selector de empresas para ese usuario y el estado de enrolamiento en la lista de autorizados cambiará a no enrolado.

## Consideraciones importantes

- Operación reversible: el usuario puede ser reenrolado manualmente si es necesario
- No elimina la entidad del sistema, solo remueve permisos de emisión
- Requiere los mismos permisos que para enrolar
- Actualiza automáticamente el estado en la lista de autorizados

## Relación con otros endpoints

- **GET /honorary/master-entities/{master_entity_id}/authorized-users/**: Lista usuarios y su estado de enrolamiento
- **PATCH /honorary/master-entities/{master_entity_id}/authorized-users/{rut}/** con `action="enroll"`: Operación inversa (enrolar)
- **PATCH /honorary/master-entities/{master_entity_id}/authorized-users/{rut}/** con `action="unenroll"`: Esta operación (desenrolar)