---
title: 'Crear webhook'
openapi: 'POST /api/v1/webhooks'
---

## Qué hace

- Crea un nuevo webhook para la empresa del usuario autenticado
- Configura la URL de callback para recibir notificaciones de eventos
- Define qué eventos específicos activarán el webhook
- Establece credenciales de autenticación para validar las notificaciones

## Ejemplos de uso

- Configurar notificaciones automáticas cuando se emiten documentos
- Recibir alertas cuando documentos son aceptados o rechazados por el SII
- Integrar con sistemas externos para procesamiento automático de documentos
- Monitorear el estado de entrega de documentos importantes

## Requisitos

### Entidad maestra
- Debes tener configurada una entidad maestra (`master_entity`) en Tu Pana
- El webhook se asocia automáticamente a la entidad del usuario autenticado

### Eventos disponibles
- `document.issued` - Documento emitido exitosamente
- `document.delivered` - Documento entregado al receptor
- `document.accepted` - Documento aceptado por el SII
- `document.rejected` - Documento rechazado por el SII

## Request Body

### master_entity_id (Obligatorio)
- **Tipo:** Integer
- **Descripción:** ID de la entidad maestra a la que pertenece el webhook

### url (Obligatorio)
- **Tipo:** String
- **Descripción:** URL de callback que recibirá las notificaciones
- **Validación:** Debe ser una URL válida y accesible desde internet

### events (Obligatorio)
- **Tipo:** Array de strings
- **Descripción:** Lista de eventos que activarán el webhook
- **Valores permitidos:** `["document.issued", "document.delivered", "document.accepted", "document.rejected"]`
- **Mínimo:** 1 evento
- **Máximo:** 4 eventos

### secret (Opcional)
- **Tipo:** String
- **Descripción:** Clave secreta para validar la autenticidad de las notificaciones
- **Longitud máxima:** 255 caracteres
- **Recomendación:** Usar una clave segura y única

## Respuesta exitosa

### 201 Created
```json
{
  "id": 1,
  "url": "https://mi-sistema.com/webhook/callback",
  "events": ["document.issued", "document.delivered"],
  "events_display": ["Emitido", "Entregado"],
  "secret": "mi-clave-secreta",
  "is_active": true,
  "last_status_code": null,
  "last_sent_at": null,
  "success_rate": 0.0,
  "last_delivery": null,
  "created_at": "2025-01-13T10:30:00Z",
  "updated_at": "2025-01-13T10:30:00Z"
}
```

## Errores comunes

### 400 Bad Request
- URL inválida o inaccesible
- Eventos no válidos
- Entidad maestra no encontrada

### 401 Unauthorized
- Usuario no autenticado
- Token inválido o expirado

### 403 Forbidden
- Usuario sin acceso a la entidad especificada

### 422 Unprocessable Entity
- Datos de entrada inválidos
- Violación de restricciones de negocio